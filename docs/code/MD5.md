## MD5（Message-digest algorithm 5） 是什么玩意？

MD5 是信息摘要的一种实现，它可以从任意长度的明文字符串生成128位的哈希值。

## 支付场景MD5摘要哈希生成的正确姿势

1.收集相关业务参数，在这里是金额和目标账户。当然，实际应用中的参数肯定比这多得多，这里只是做了简化。

2.按照规则，把参数名和参数值拼接成一个字符串，同时把给定的`密钥`也拼接起来。之所以需要密钥，是因为攻击者也可能获知拼接规则。

3.利用MD5算法，从原文生成哈希值。MD5生成的哈希值是128位的二进制数，也就是32位的十六进制数

## 第三方支付平台如何验证请求的签名？同样

1.发送方和请求方约定相同的字符串拼接规则，约定`相同的密钥`。

2.第三方平台接到支付请求，按规则拼接业务参数和密钥，利用MD5算法生成Sign。

3.用第三方平台自己生成的Sign和请求发送过来的Sign做对比，如果两个Sign值一模一样，则摘要无误，如果两个Sign值不同，则信息做了篡改。这个过程叫做**验签**。